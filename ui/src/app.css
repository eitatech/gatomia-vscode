@import "tailwindcss";
@import "tw-animate-css";
@import "highlight.js/styles/vs2015.css";
@plugin "@tailwindcss/typography";

@custom-variant dark (&:is(.dark *));

body {
	font-family: var(--vscode-font-family);
	font-weight: var(--vscode-font-weight);
	font-size: var(--vscode-font-size);
	color: var(--vscode-foreground);
	background-color: var(--vscode-editor-background);
}

@theme inline {
	--radius-sm: calc(var(--radius) - 4px);
	--radius-md: calc(var(--radius) - 2px);
	--radius-lg: var(--radius);
	--radius-xl: calc(var(--radius) + 4px);
	--color-background: var(--background);
	--color-foreground: var(--foreground);
	--color-card: var(--card);
	--color-card-foreground: var(--card-foreground);
	--color-popover: var(--popover);
	--color-popover-foreground: var(--popover-foreground);
	--color-primary: var(--primary);
	--color-primary-foreground: var(--primary-foreground);
	--color-secondary: var(--secondary);
	--color-secondary-foreground: var(--secondary-foreground);
	--color-muted: var(--muted);
	--color-muted-foreground: var(--muted-foreground);
	--color-accent: var(--accent);
	--color-accent-foreground: var(--accent-foreground);
	--color-destructive: var(--destructive);
	--color-border: var(--border);
	--color-input: var(--input);
	--color-ring: var(--ring);
	--color-chart-1: var(--chart-1);
	--color-chart-2: var(--chart-2);
	--color-chart-3: var(--chart-3);
	--color-chart-4: var(--chart-4);
	--color-chart-5: var(--chart-5);
	--color-sidebar: var(--sidebar);
	--color-sidebar-foreground: var(--sidebar-foreground);
	--color-sidebar-primary: var(--sidebar-primary);
	--color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
	--color-sidebar-accent: var(--sidebar-accent);
	--color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
	--color-sidebar-border: var(--sidebar-border);
	--color-sidebar-ring: var(--sidebar-ring);
}

:root {
	--radius: 0.625rem;
	--background: oklch(1 0 0);
	--foreground: oklch(0.145 0 0);
	--card: oklch(1 0 0);
	--card-foreground: oklch(0.145 0 0);
	--popover: oklch(1 0 0);
	--popover-foreground: oklch(0.145 0 0);
	--primary: oklch(0.205 0 0);
	--primary-foreground: oklch(0.985 0 0);
	--secondary: oklch(0.97 0 0);
	--secondary-foreground: oklch(0.205 0 0);
	--muted: oklch(0.97 0 0);
	--muted-foreground: oklch(0.556 0 0);
	--accent: oklch(0.97 0 0);
	--accent-foreground: oklch(0.205 0 0);
	--destructive: oklch(0.577 0.245 27.325);
	--border: oklch(0.922 0 0);
	--input: oklch(0.922 0 0);
	--ring: oklch(0.708 0 0);
	--chart-1: oklch(0.646 0.222 41.116);
	--chart-2: oklch(0.6 0.118 184.704);
	--chart-3: oklch(0.398 0.07 227.392);
	--chart-4: oklch(0.828 0.189 84.429);
	--chart-5: oklch(0.769 0.188 70.08);
	--sidebar: oklch(0.985 0 0);
	--sidebar-foreground: oklch(0.145 0 0);
	--sidebar-primary: oklch(0.205 0 0);
	--sidebar-primary-foreground: oklch(0.985 0 0);
	--sidebar-accent: oklch(0.97 0 0);
	--sidebar-accent-foreground: oklch(0.205 0 0);
	--sidebar-border: oklch(0.922 0 0);
	--sidebar-ring: oklch(0.708 0 0);
}

.dark {
	--background: oklch(0.145 0 0);
	--foreground: oklch(0.985 0 0);
	--card: oklch(0.205 0 0);
	--card-foreground: oklch(0.985 0 0);
	--popover: oklch(0.205 0 0);
	--popover-foreground: oklch(0.985 0 0);
	--primary: oklch(0.922 0 0);
	--primary-foreground: oklch(0.205 0 0);
	--secondary: oklch(0.269 0 0);
	--secondary-foreground: oklch(0.985 0 0);
	--muted: oklch(0.269 0 0);
	--muted-foreground: oklch(0.708 0 0);
	--accent: oklch(0.269 0 0);
	--accent-foreground: oklch(0.985 0 0);
	--destructive: oklch(0.704 0.191 22.216);
	--border: oklch(1 0 0 / 10%);
	--input: oklch(1 0 0 / 15%);
	--ring: oklch(0.556 0 0);
	--chart-1: oklch(0.488 0.243 264.376);
	--chart-2: oklch(0.696 0.17 162.48);
	--chart-3: oklch(0.769 0.188 70.08);
	--chart-4: oklch(0.627 0.265 303.9);
	--chart-5: oklch(0.645 0.246 16.439);
	--sidebar: oklch(0.205 0 0);
	--sidebar-foreground: oklch(0.985 0 0);
	--sidebar-primary: oklch(0.488 0.243 264.376);
	--sidebar-primary-foreground: oklch(0.985 0 0);
	--sidebar-accent: oklch(0.269 0 0);
	--sidebar-accent-foreground: oklch(0.985 0 0);
	--sidebar-border: oklch(1 0 0 / 10%);
	--sidebar-ring: oklch(0.556 0 0);
}

@layer base {
	* {
		@apply border-border outline-ring/50;
	}

	body {
		@apply bg-background text-foreground;
	}
}

/* Task list checkbox styles for markdown preview */
.task-list-item {
	list-style-type: none;
	position: relative;
	margin-left: -1.5em;
	padding-left: 0;
}

.task-list-item::before {
	content: none;
}

.task-list-checkbox {
	appearance: none;
	-webkit-appearance: none;
	width: 1em;
	height: 1em;
	border: 1px solid var(--vscode-checkbox-border, #6b6b6b);
	border-radius: 3px;
	background-color: var(--vscode-checkbox-background, transparent);
	vertical-align: middle;
	margin-right: 0.5em;
	cursor: default;
	position: relative;
}

.task-list-checkbox:checked {
	background-color: var(--vscode-checkbox-selectBackground, #0078d4);
	border-color: var(--vscode-checkbox-selectBorder, #0078d4);
}

.task-list-checkbox:checked::after {
	content: "";
	position: absolute;
	left: 3px;
	top: 0;
	width: 4px;
	height: 8px;
	border: solid var(--vscode-checkbox-foreground, #fff);
	border-width: 0 2px 2px 0;
	transform: rotate(45deg);
}

/* Ensure task lists in prose context look good */
.prose .task-list-item {
	padding-left: 0.25em;
}

.prose ul:has(.task-list-item) {
	padding-left: 1.5em;
}

/* Inline code styling for markdown preview */
.prose code {
	background-color: var(--vscode-textCodeBlock-background, rgba(255, 255, 255, 0.1));
	color: var(--vscode-editor-foreground, inherit);
	padding: 0.125em 0.375em;
	border-radius: 3px;
	font-family: var(--vscode-editor-font-family, monospace);
	font-size: 0.875em;
}

/* Only apply nowrap to inline code, not code blocks */
.prose p code,
.prose li code,
.prose td code,
.prose th code {
	white-space: nowrap;
}

.prose code::before,
.prose code::after {
	content: none;
}

/* Code block styling for markdown preview */
.prose pre {
	background-color: var(--vscode-textCodeBlock-background, rgba(0, 0, 0, 0.3));
	border: 1px solid var(--vscode-input-border, #3c3c3c);
	border-radius: 6px;
	padding: 1rem;
	overflow-x: auto;
	margin: 0.75rem 0;
}

.prose pre code {
	background-color: transparent;
	padding: 0;
	border-radius: 0;
	font-size: 0.8125rem;
	line-height: 1.5;
	white-space: pre;
	font-family: var(--vscode-editor-font-family, "Fira Code", "Consolas", monospace);
}

/* Prose spacing overrides - reduce excessive line height */
.prose {
	line-height: 1.6;
}

.prose p {
	margin-top: 0.75em;
	margin-bottom: 0.75em;
	line-height: 1.6;
}

.prose ul,
.prose ol {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.prose li {
	margin-top: 0.25em;
	margin-bottom: 0.25em;
}

.prose h1,
.prose h2,
.prose h3,
.prose h4,
.prose h5,
.prose h6 {
	margin-top: 1em;
	margin-bottom: 0.5em;
	line-height: 1.3;
}

.prose blockquote {
	margin-top: 0.75em;
	margin-bottom: 0.75em;
	padding-left: 1em;
	border-left: 3px solid var(--vscode-textBlockQuote-border, #007acc);
}

/* Mermaid diagram styling */
.prose .mermaid {
	background-color: var(--vscode-editor-background, #1e1e1e);
	border-radius: 6px;
	padding: 1rem;
	margin: 0.75rem 0;
	text-align: center;
	overflow-x: auto;
}

/* Strong/bold text styling for markdown preview */
.prose strong,
.prose b {
	font-weight: 700 !important;
	color: inherit;
}

/* Emphasis/italic text styling for markdown preview */
.prose em,
.prose i {
	font-style: italic !important;
	color: inherit;
}

/* Ensure emphasis works in headings too */
.prose h1 em,
.prose h1 i,
.prose h2 em,
.prose h2 i,
.prose h3 em,
.prose h3 i,
.prose h4 em,
.prose h4 i,
.prose h5 em,
.prose h5 i,
.prose h6 em,
.prose h6 i {
	font-style: italic !important;
}

/* Ensure bold works in headings too */
.prose h1 strong,
.prose h1 b,
.prose h2 strong,
.prose h2 b,
.prose h3 strong,
.prose h3 b,
.prose h4 strong,
.prose h4 b,
.prose h5 strong,
.prose h5 b,
.prose h6 strong,
.prose h6 b {
	font-weight: 700 !important;
}

@layer components {

	/* Override Tailwind prose em/strong styles */
	.prose :where(em):not(:where([class~="not-prose"] *)) {
		font-style: italic !important;
		font-weight: inherit;
	}

	.prose :where(i):not(:where([class~="not-prose"] *)) {
		font-style: italic !important;
		font-weight: inherit;
	}

	.prose :where(strong):not(:where([class~="not-prose"] *)) {
		font-weight: 700 !important;
		font-style: inherit;
	}

	.prose :where(b):not(:where([class~="not-prose"] *)) {
		font-weight: 700 !important;
		font-style: inherit;
	}
}

/* Ultra-specific selectors to override Tailwind */
.prose h2 em,
.prose h2 i {
	font-style: italic !important;
	letter-spacing: 0 !important;
	text-decoration: none !important;
	font-weight: inherit !important;
	color: inherit !important;
	opacity: 1 !important;
	transform: none !important;
}

.prose h2 strong,
.prose h2 b {
	font-weight: 700 !important;
	font-style: inherit !important;
	letter-spacing: 0 !important;
	text-decoration: none !important;
	color: inherit !important;
	opacity: 1 !important;
	transform: none !important;
}

/* Global em/strong override */
em,
i {
	font-style: italic !important;
}

strong,
b {
	font-weight: 700 !important;
}

/* --- Mermaid Viewer Styles (Ported from vscode-markdown-mermaid) --- */

.mermaid-zoom-controls {
	position: absolute;
	top: 4px;
	right: 4px;
	display: flex;
	width: auto;
	gap: 2px;
	z-index: 100;
	background: var(--vscode-editorWidget-background);
	border: 1px solid var(--vscode-editorWidget-border, transparent);
	border-radius: 6px;
	padding: 2px;
}

/* Ensure icons are visible */
.mermaid-zoom-controls button {
	display: flex;
	align-items: center;
	justify-content: center;
	width: 22px;
	height: 22px;
	background: transparent;
	color: var(--vscode-icon-foreground);
	border: none;
	border-radius: 4px;
	cursor: pointer;
	padding: 0;
}

.mermaid-zoom-controls button:hover {
	background: var(--vscode-toolbar-hoverBackground);
}

.mermaid-zoom-controls button.active {
	background: var(--vscode-toolbar-activeBackground);
	color: var(--vscode-focusBorder);
}

.mermaid-wrapper {
	position: relative;
	width: 100%;
	overflow: hidden;
	border: 1px solid transparent;
	border-radius: 4px;
	transition: border-color 0.2s ease-in-out;
	margin-bottom: 1em;
	background-color: var(--vscode-editor-background);
}

.mermaid-wrapper:hover,
.mermaid-wrapper:focus,
.mermaid-wrapper:focus-within {
	border-color: var(--vscode-editorWidget-border);
}

.mermaid-content {
	transform-origin: 0 0;
	/* Removed flex properties to avoid conflict with JS layout logic */
}

.mermaid-resize-handle {
	position: absolute;
	bottom: 0;
	left: 0;
	right: 0;
	height: 10px;
	cursor: ns-resize;
	background: transparent;
	z-index: 50;
}

.mermaid-resize-handle::after {
	content: '';
	position: absolute;
	bottom: 2px;
	left: 50%;
	transform: translateX(-50%);
	width: 40px;
	height: 3px;
	background: var(--vscode-editorWidget-border, rgba(128, 128, 128, 0.4));
	border-radius: 2px;
	opacity: 0;
	transition: opacity 0.15s ease-in-out;
}

.mermaid-resize-handle:hover::after {
	opacity: 1;
	transition-delay: 0.3s;
}

.mermaid-error {
	color: var(--vscode-errorForeground);
	padding: 1rem;
	font-family: monospace;
}